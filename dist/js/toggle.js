(function(e){"use strict";const D={class:"flex items-center gap-2"},S={key:0,class:"help-text text-xs italic"},L=e.defineComponent({__name:"DetailToggle",props:{index:{},field:{},resource:{},resourceName:{},resourceId:{}},setup(l){const o=l,s=e.ref(o.field.value??!1),n=e.ref(!1);let c=null;const b=e.computed(()=>({color:s.value?n.value?o.field.onLabelColorDark:o.field.onLabelColor:n.value?o.field.offLabelColorDark:o.field.offLabelColor,fontSize:"6px",padding:"0 6px"})),d=e.computed(()=>{const f=n.value?o.field.onBulletColorDark:o.field.onBulletColor,C=n.value?o.field.offBulletColorDark:o.field.offBulletColor;return{backgroundColor:s.value?f:C,transform:s.value?"translateX(1.25rem)":"translateX(0)"}}),p=e.computed(()=>{const f=n.value?o.field.onColorDark:o.field.onColor,C=n.value?o.field.offColorDark:o.field.offColor;return{backgroundColor:s.value?f:C}}),k=f=>{n.value=f.matches};return e.onMounted(()=>{c=window.matchMedia("(prefers-color-scheme: dark)"),n.value=c.matches,c.addEventListener("change",k)}),e.onBeforeUnmount(()=>{c==null||c.removeEventListener("change",k)}),(f,C)=>{const v=e.resolveComponent("PanelItem");return e.openBlock(),e.createBlock(v,{index:l.index,field:l.field},{value:e.withCtx(()=>[e.createElementVNode("div",D,[e.createElementVNode("label",{class:"group pointer-events-none relative inline-flex h-5 w-10 shrink-0 items-center overflow-hidden rounded-full opacity-50 inset-ring inset-ring-gray-900/5 outline-offset-2 outline-indigo-600 transition-colors duration-200 ease-in-out",style:e.normalizeStyle([{padding:"2.25px"},p.value])},[l.field.onLabel||l.field.offLabel?(e.openBlock(),e.createElementBlock("span",{key:0,class:e.normalizeClass(["pointer-events-none absolute inset-0 flex items-center font-medium tracking-wide uppercase",s.value?"justify-start":"justify-end"]),style:e.normalizeStyle(b.value)},e.toDisplayString(s.value?l.field.onLabel:l.field.offLabel),7)):e.createCommentVNode("",!0),e.createElementVNode("span",{class:"inline-block h-4 w-4 rounded-full shadow-xs ring-1 ring-gray-900/5 transition-transform duration-200 ease-in-out",style:e.normalizeStyle(d.value)},null,4)],4),l.field.helpOnDetail&&!l.field.hidden?(e.openBlock(),e.createElementBlock("p",S,e.toDisplayString(l.field.helpOnDetail),1)):e.createCommentVNode("",!0)])]),_:1},8,["index","field"])}}});function N(){const l=e.getCurrentInstance(),o=l==null?void 0:l.props,s=e.ref(null),n=e.computed(()=>o.field),c=e.computed(()=>{var r;return((r=o.field)==null?void 0:r.attribute)||""}),b=e.computed(()=>{var r;return((r=o.field)==null?void 0:r.visible)!==!1}),d=e.computed(()=>{var r;return((r=o.field)==null?void 0:r.readonly)||!1}),p=()=>{var r;s.value=((r=o.field)==null?void 0:r.value)??!1},k=()=>!1,f=(r,a,t)=>{r.append(a,t)},C=(r,a,t)=>{b.value&&f(r,a,t)},v=r=>{const a=c.value;a&&C(r,a,s.value?1:0)},w=(r,a)=>{var t;(t=window.Nova)==null||t.$emit(`${r}-value`,a)};return e.onMounted(()=>{o.field&&(o.field.fill=v)}),{value:s,currentField:n,fieldAttribute:c,isVisible:b,currentlyIsReadonly:d,setInitialValue:p,fieldDefaultValue:k,fillInto:f,fillIfVisible:C,fill:v,emitFieldValueChange:w,loading:e.ref(!1)}}const E={class:"mt-1 flex items-center gap-2"},I={key:0,class:"help-text text-xs italic"},V=e.defineComponent({__name:"FormToggle",props:{resourceName:{},resourceId:{},field:{},errors:{},showHelpText:{type:Boolean},fullWidthContent:{type:Boolean}},setup(l){const{currentField:o,value:s,loading:n,currentlyIsReadonly:c,setInitialValue:b}=N(),d=e.ref(!1);let p=null;const k=()=>{c.value||(s.value=!s.value)},f=e.computed(()=>!!s.value),C=e.computed(()=>{var i;return[n.value||(i=o.value)!=null&&i.readonly?"pointer-events-none cursor-default opacity-50":"cursor-pointer opacity-100"]}),v=e.computed(()=>{var i;return[n.value||(i=o.value)!=null&&i.readonly?"pointer-events-none":"cursor-pointer"]}),w=e.computed(()=>{var i,y,g,m;return{color:s.value?d.value?(i=o.value)==null?void 0:i.onLabelColorDark:(y=o.value)==null?void 0:y.onLabelColor:d.value?(g=o.value)==null?void 0:g.offLabelColorDark:(m=o.value)==null?void 0:m.offLabelColor}}),r=e.computed(()=>{var g,m,h,u;const i=d.value?(g=o.value)==null?void 0:g.onBulletColorDark:(m=o.value)==null?void 0:m.onBulletColor,y=d.value?(h=o.value)==null?void 0:h.offBulletColorDark:(u=o.value)==null?void 0:u.offBulletColor;return{backgroundColor:f.value?i:y,transform:f.value?"translateX(1.25rem)":"translateX(0)"}}),a=e.computed(()=>{var g,m,h,u;const i=d.value?(g=o.value)==null?void 0:g.onColorDark:(m=o.value)==null?void 0:m.onColor,y=d.value?(h=o.value)==null?void 0:h.offColorDark:(u=o.value)==null?void 0:u.offColor;return{backgroundColor:f.value?i:y}}),t=i=>{d.value=i.matches};return e.onMounted(()=>{b(),p=window.matchMedia("(prefers-color-scheme: dark)"),d.value=p.matches,p.addEventListener("change",t)}),e.onBeforeUnmount(()=>{p==null||p.removeEventListener("change",t)}),(i,y)=>{const g=e.resolveComponent("DefaultField");return e.openBlock(),e.createBlock(g,{field:e.unref(o),errors:l.errors,"full-width-content":l.fullWidthContent},{field:e.withCtx(()=>{var m,h,u,x,B;return[e.createElementVNode("div",E,[e.createElementVNode("label",{class:e.normalizeClass(["group relative inline-flex h-5 w-10 shrink-0 items-center overflow-hidden rounded-full inset-ring inset-ring-gray-900/5 outline-offset-2 outline-indigo-600 transition-colors duration-200 ease-in-out has-focus-visible:outline-2",C.value]),style:e.normalizeStyle([{padding:"2.01px"},a.value]),onClick:k},[(m=e.unref(o))!=null&&m.onLabel||(h=e.unref(o))!=null&&h.offLabel?(e.openBlock(),e.createElementBlock("span",{key:0,class:e.normalizeClass(["pointer-events-none absolute inset-0 flex items-center px-1.5 font-medium tracking-wide uppercase",f.value?"justify-start":"justify-end"]),style:e.normalizeStyle({...w.value,fontSize:"6px"})},e.toDisplayString(f.value?(u=e.unref(o))==null?void 0:u.onLabel:(x=e.unref(o))==null?void 0:x.offLabel),7)):e.createCommentVNode("",!0),e.createElementVNode("span",{class:e.normalizeClass(["inline-block h-4 w-4 rounded-full shadow-xs ring-1 ring-gray-900/5 transition-transform duration-200 ease-in-out",v.value]),style:e.normalizeStyle(r.value)},null,6)],6),(B=e.unref(o))!=null&&B.helpOnForm?(e.openBlock(),e.createElementBlock("p",I,e.toDisplayString(e.unref(o).helpOnForm),1)):e.createCommentVNode("",!0)])]}),_:1},8,["field","errors","full-width-content"])}}}),z={key:0,class:"h-5 w-10"},$=["aria-label","name","checked","disabled"],T={key:0,class:"help-text text-xs italic"},M=e.defineComponent({__name:"IndexToggle",props:{field:{},resourceName:{},resourceId:{},resource:{}},setup(l){const o=l,s=e.ref(!1),n=e.ref(o.field.value??!1),c=e.ref(!1),b=e.computed(()=>{var a,t,i;return o.resourceId?o.resourceId:(t=(a=o.resource)==null?void 0:a.id)!=null&&t.value?o.resource.id.value:(i=o.resource)!=null&&i.id?o.resource.id:(console.error("IndexToggle: No resource ID found",{resourceId:o.resourceId,resource:o.resource,field:o.field}),null)});let d=null;const p=e.computed(()=>s.value||o.field.readonly?"cursor-default":"cursor-pointer"),k=e.computed(()=>[s.value||o.field.readonly?"pointer-events-none cursor-default opacity-50":"cursor-pointer opacity-100"]),f=e.computed(()=>({color:n.value?c.value?o.field.onLabelColorDark:o.field.onLabelColor:c.value?o.field.offLabelColorDark:o.field.offLabelColor,fontSize:"6px",padding:"0 6px"})),C=e.computed(()=>{const a=c.value?o.field.onBulletColorDark:o.field.onBulletColor,t=c.value?o.field.offBulletColorDark:o.field.offBulletColor;return{backgroundColor:n.value?a:t,transform:n.value?"translateX(1.25rem)":"translateX(0)"}}),v=e.computed(()=>{const a=c.value?o.field.onColorDark:o.field.onColor,t=c.value?o.field.offColorDark:o.field.offColor;return{backgroundColor:n.value?a:t}}),w=async()=>{var t,i,y,g,m,h;if(o.field.readonly||s.value)return;if(!b.value){(t=Nova.$toasted)==null||t.show("Error: Resource ID not found",{type:"error"}),console.error("Cannot toggle: No resource ID",o);return}const a=n.value;n.value=!a,s.value=!0;try{const u=`/nova-vendor/nova-toggle/toggle/${o.resourceName}/${b.value}`;console.log("Toggle request:",{url:u,attribute:o.field.attribute});const x=await Nova.request().post(u,{attribute:o.field.attribute,labelKey:o.field.toastLabelKey});if((i=x.data)!=null&&i.success){if(n.value=!!x.data.value,o.field.toastShow!==!1){const B=()=>{const F=n.value?"activated":"deactivated";return`"${x.data.label||o.field.name}" ${F}!`};(y=Nova.$toasted)==null||y.show(B(),{type:"success"})}}else throw new Error("Invalid response from server")}catch(u){console.error("Toggle error:",u),n.value=a;const x=((m=(g=u.response)==null?void 0:g.data)==null?void 0:m.message)||u.message||"Error occurred.";(h=Nova.$toasted)==null||h.show(x,{type:"error"})}finally{s.value=!1}},r=a=>{c.value=a.matches};return e.onMounted(()=>{var t;const a=sessionStorage.getItem("nova-toggle-message");a&&(sessionStorage.removeItem("nova-toggle-message"),(t=Nova.$toasted)==null||t.show(a,{type:"success",duration:3e3})),d=window.matchMedia("(prefers-color-scheme: dark)"),c.value=d.matches,d.addEventListener("change",r)}),e.onBeforeUnmount(()=>{d==null||d.removeEventListener("change",r)}),(a,t)=>(e.openBlock(),e.createElementBlock("div",{class:"flex items-center gap-2",onClick:t[2]||(t[2]=e.withModifiers(()=>{},["stop"]))},[l.field.hidden?(e.openBlock(),e.createElementBlock("div",z)):(e.openBlock(),e.createElementBlock("div",{key:1,class:e.normalizeClass(["flex items-center gap-2",s.value||l.field.readonly?"cursor-default":"cursor-pointer"])},[e.createElementVNode("label",{class:e.normalizeClass(["group disabled:pointer-events-non relative inline-flex h-5 w-10 shrink-0 items-center overflow-hidden rounded-full inset-ring inset-ring-gray-900/5 outline-offset-2 outline-indigo-600 transition-colors duration-200 ease-in-out disabled:opacity-50 has-focus-visible:outline-2",k.value]),style:e.normalizeStyle([{padding:"2.01px"},v.value]),onClick:t[1]||(t[1]=e.withModifiers(()=>{},["stop"]))},[l.field.onLabel||l.field.offLabel?(e.openBlock(),e.createElementBlock("span",{key:0,class:e.normalizeClass(["pointer-events-none absolute inset-0 flex items-center font-medium tracking-wide uppercase",n.value?"justify-start":"justify-end"]),style:e.normalizeStyle(f.value)},e.toDisplayString(n.value?l.field.onLabel:l.field.offLabel),7)):e.createCommentVNode("",!0),e.createElementVNode("input",{type:"checkbox",class:e.normalizeClass([p.value,"absolute inset-0 appearance-none opacity-0 focus:outline-hidden disabled:pointer-events-none"]),"aria-label":`Toggle ${l.field.attribute}`,name:l.field.attribute,checked:n.value,disabled:s.value||l.field.readonly,onChange:w,onClick:t[0]||(t[0]=e.withModifiers(()=>{},["stop"]))},null,42,$),e.createElementVNode("span",{class:"inline-block h-4 w-4 rounded-full shadow-xs ring-1 ring-gray-900/5 transition-transform duration-200 ease-in-out",style:e.normalizeStyle(C.value)},null,4)],6),l.field.helpOnIndex&&!l.field.hidden?(e.openBlock(),e.createElementBlock("p",T,e.toDisplayString(l.field.helpOnIndex),1)):e.createCommentVNode("",!0)],2))]))}});Nova.booting(l=>{l.component("index-nova-toggle",M),l.component("detail-nova-toggle",L),l.component("form-nova-toggle",V)})})(Vue);
